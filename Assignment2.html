<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ari Gestetner">
<meta name="author" content="Nathan Giofkou">
<meta name="author" content="Mitchell Evans">

<title>Assignment 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Assignment2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment2_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Assignment2_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Assignment2_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment2_files/libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment2_files/libs/bootstrap/bootstrap-a525d2d6c3e62ef3c3ad544944990be8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#stationarity" id="toc-stationarity" class="nav-link active" data-scroll-target="#stationarity">Stationarity</a>
  <ul class="collapse">
  <li><a href="#original-series" id="toc-original-series" class="nav-link" data-scroll-target="#original-series">Original Series</a>
  <ul class="collapse">
  <li><a href="#time-series-plots" id="toc-time-series-plots" class="nav-link" data-scroll-target="#time-series-plots">Time Series Plots</a></li>
  <li><a href="#acfs-for-each-series" id="toc-acfs-for-each-series" class="nav-link" data-scroll-target="#acfs-for-each-series">ACF’s for Each Series</a></li>
  <li><a href="#pacfs-for-each-series" id="toc-pacfs-for-each-series" class="nav-link" data-scroll-target="#pacfs-for-each-series">PACF’s for Each Series</a></li>
  <li><a href="#formal-hypothesis-tests-to-determine-stationarity-adf-and-kpss" id="toc-formal-hypothesis-tests-to-determine-stationarity-adf-and-kpss" class="nav-link" data-scroll-target="#formal-hypothesis-tests-to-determine-stationarity-adf-and-kpss">Formal Hypothesis tests to determine stationarity (ADF and KPSS):</a></li>
  </ul></li>
  <li><a href="#first-difference-series" id="toc-first-difference-series" class="nav-link" data-scroll-target="#first-difference-series">First Difference Series</a>
  <ul class="collapse">
  <li><a href="#differenced-series-plots" id="toc-differenced-series-plots" class="nav-link" data-scroll-target="#differenced-series-plots">Differenced Series Plots</a></li>
  </ul></li>
  <li><a href="#differenced-series-acfs" id="toc-differenced-series-acfs" class="nav-link" data-scroll-target="#differenced-series-acfs">Differenced series ACF’s</a></li>
  <li><a href="#differenced-series-pacfs" id="toc-differenced-series-pacfs" class="nav-link" data-scroll-target="#differenced-series-pacfs">Differenced series PACF’s</a></li>
  <li><a href="#formal-hypothesis-tests-to-determine-stationarity-adf-and-kpss-1" id="toc-formal-hypothesis-tests-to-determine-stationarity-adf-and-kpss-1" class="nav-link" data-scroll-target="#formal-hypothesis-tests-to-determine-stationarity-adf-and-kpss-1">Formal Hypothesis tests to determine stationarity (ADF and KPSS):</a></li>
  </ul></li>
  <li><a href="#cointegration-relationships" id="toc-cointegration-relationships" class="nav-link" data-scroll-target="#cointegration-relationships">Cointegration Relationships</a>
  <ul class="collapse">
  <li><a href="#formal-tests" id="toc-formal-tests" class="nav-link" data-scroll-target="#formal-tests">Formal Tests</a>
  <ul class="collapse">
  <li><a href="#engle---granger-test" id="toc-engle---granger-test" class="nav-link" data-scroll-target="#engle---granger-test">Engle - Granger Test</a></li>
  <li><a href="#johansen-test" id="toc-johansen-test" class="nav-link" data-scroll-target="#johansen-test">Johansen Test</a></li>
  </ul></li>
  <li><a href="#implications-for-modelling" id="toc-implications-for-modelling" class="nav-link" data-scroll-target="#implications-for-modelling">Implications for Modelling</a>
  <ul class="collapse">
  <li><a href="#what-if-there-was-one-or-more-cointgrating-relationship" id="toc-what-if-there-was-one-or-more-cointgrating-relationship" class="nav-link" data-scroll-target="#what-if-there-was-one-or-more-cointgrating-relationship">What if There Was One or More Cointgrating Relationship</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#impluse-response-analysis" id="toc-impluse-response-analysis" class="nav-link" data-scroll-target="#impluse-response-analysis">Impluse Response Analysis</a>
  <ul class="collapse">
  <li><a href="#impulse-response-plots-for-textvar1" id="toc-impulse-response-plots-for-textvar1" class="nav-link" data-scroll-target="#impulse-response-plots-for-textvar1">Impulse Response Plots for <span class="math inline">\(\text{VAR}(1)\)</span></a></li>
  <li><a href="#plot-goes-here" id="toc-plot-goes-here" class="nav-link" data-scroll-target="#plot-goes-here">PLOT GOES HERE</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Assignment2.pdf"><i class="bi bi-file-pdf"></i>PDF (report)</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assignment 2</h1>
<p class="subtitle lead">Housing Data: Effects of Rezoning Plans</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Ari Gestetner <a href="mailto:ages0001@student.monash.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
             <p>Nathan Giofkou <a href="mailto:ngio0003@student.monash.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
             <p>Mitchell Evans <a href="mailto:meva0009@student.monash.edu" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>renv<span class="sc">::</span><span class="fu">load</span>(<span class="st">"Assignment2"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">setwd</span>(<span class="st">"Assignment2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">library</span>(feasts)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">library</span>(urca)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="fu">library</span>(tseries)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">library</span>(egcm)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="fu">library</span>(vars)</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">16</span>))</span>
<span id="cb2-11"><a href="#cb2-11"></a></span>
<span id="cb2-12"><a href="#cb2-12"></a>housingdata <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./housingdata.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>  <span class="fu">tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>  <span class="fu">mutate</span>(<span class="at">date=</span><span class="fu">yearquarter</span>(date)) <span class="sc">|&gt;</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>  <span class="fu">as_tsibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="stationarity" class="level1">
<h1>Stationarity</h1>
<p>This analysis will be conducted using price data for Melbourne house (<span class="math inline">\(\texttt{house\_mel}\)</span>) and apartment (<span class="math inline">\(\texttt{appt\_mel}\)</span>) prices, along with Sydney house (<span class="math inline">\(\texttt{house\_syd}\)</span>) and apartment (<span class="math inline">\(\texttt{appt\_syd}\)</span>) prices. These data sets range from Q3 2003 to Q2 2025.</p>
<p>To guide the first steps, it must be determined whether the series mentioned are stationary, or if they have a unit root and require differencing of the series. Only after this is determined can the analysis move onto modelling and forecasting effects.</p>
<section id="original-series" class="level2">
<h2 class="anchored" data-anchor-id="original-series">Original Series</h2>
<section id="time-series-plots" class="level3">
<h3 class="anchored" data-anchor-id="time-series-plots">Time Series Plots</h3>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>housingdata <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>house_mel)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Price"</span>, <span class="at">title=</span><span class="st">'Melbourne Median House Prices Over Time'</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb3-5"><a href="#cb3-5"></a>housingdata <span class="sc">|&gt;</span> </span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>appt_mel)) <span class="sc">+</span> </span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Price"</span>, <span class="at">title=</span><span class="st">'Melbourne Median Apartment Prices Over Time'</span>) <span class="sc">+</span> </span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb3-9"><a href="#cb3-9"></a>housingdata <span class="sc">|&gt;</span> </span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>house_syd)) <span class="sc">+</span> </span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Price"</span>, <span class="at">title=</span><span class="st">'Sydney Median House Prices Over Time'</span>) <span class="sc">+</span> </span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb3-13"><a href="#cb3-13"></a>housingdata <span class="sc">|&gt;</span> </span>
<span id="cb3-14"><a href="#cb3-14"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>appt_syd)) <span class="sc">+</span> </span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Price"</span>, <span class="at">title=</span><span class="st">'Sydney Median Apartment Prices Over Time'</span>) <span class="sc">+</span> </span>
<span id="cb3-16"><a href="#cb3-16"></a>    <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" title="Plot data" data-layout="[[1,1],[1,1]]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" data-fig-pos="ht" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" data-fig-pos="ht" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-3-3.png" class="img-fluid" data-fig-pos="ht" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-3-4.png" class="img-fluid" data-fig-pos="ht" width="672"></p>
</div>
</div>
</div>
<p>Upon visual inspection of the time series plots in levels, all have an overall positive trend, and seem to be random walks with drift. The means of all series are time-dependent, indicating non-stationary. This is typical of most price data and will guide our reasoning for model specification.</p>
</section>
<section id="acfs-for-each-series" class="level3">
<h3 class="anchored" data-anchor-id="acfs-for-each-series">ACF’s for Each Series</h3>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="fu">ACF</span>(housingdata, house_mel) <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"ACF"</span>, <span class="at">title=</span><span class="st">"ACF of Melbourne Housing data"</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="fu">ACF</span>(housingdata, appt_mel) <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"ACF"</span>, <span class="at">title=</span><span class="st">"ACF of Melbourne Apartment data"</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="fu">ACF</span>(housingdata, house_syd) <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"ACF"</span>, <span class="at">title=</span><span class="st">"ACF of Sydney Housing data"</span>)</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="fu">ACF</span>(housingdata, appt_syd) <span class="sc">|&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"ACF"</span>, <span class="at">title=</span><span class="st">"ACF of Sydney Apartment data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2" title="Plot ACFs" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-4-4.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
</div>
</div>
</section>
<section id="pacfs-for-each-series" class="level3">
<h3 class="anchored" data-anchor-id="pacfs-for-each-series">PACF’s for Each Series</h3>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">PACF</span>(housingdata, house_mel) <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"PACF"</span>, <span class="at">title=</span><span class="st">"PACF of Melbourne Housing data"</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="fu">PACF</span>(housingdata, appt_mel) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"PACF"</span>, <span class="at">title=</span><span class="st">"PACF of Melbourne Apartment data"</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="fu">PACF</span>(housingdata, house_syd) <span class="sc">|&gt;</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"PACF"</span>, <span class="at">title=</span><span class="st">"PACF of Sydney Housing data"</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="fu">PACF</span>(housingdata, appt_syd) <span class="sc">|&gt;</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"PACF"</span>, <span class="at">title=</span><span class="st">"PACF of Sydney Apartment data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2" title="Plot PACFs" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
</div>
</div>
<p>The ACF’s for all series decay very slowly toward zero, which is characteristic of non-stationary processes such as those with unit roots. This suggests that shocks to the series have persistent effects, and that future values are correlated with past values. This makes intuitive sense for housing prices as they tend to evolve gradually over time rather than fluctuating randomly from period to period, as housing markets exhibit strong inertia and adjustment frictions, such as regulatory and supply constraints.</p>
<p>The PACF’s for all series have spikes at the first lag and quickly drop off, suggesting strong dependence on only the observation immediately before. This suggests most of the residual correlation is captured by the first lag which is consistent with a unit root. The spike at the first lag indicates that the series likely becomes stationary after taking first differences, which will remove the unit root. This is typical of housing price data as changes in prices are gradual and are strongly influenced by more recent movements.</p>
</section>
<section id="formal-hypothesis-tests-to-determine-stationarity-adf-and-kpss" class="level3">
<h3 class="anchored" data-anchor-id="formal-hypothesis-tests-to-determine-stationarity-adf-and-kpss">Formal Hypothesis tests to determine stationarity (ADF and KPSS):</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># ADF test (hm_ stands for homes melbourne)</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>hm_adf_result <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(housingdata<span class="sc">$</span>house_mel, <span class="at">type =</span> <span class="st">"drift"</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>) </span>
<span id="cb6-3"><a href="#cb6-3"></a>hm_adf_result_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(hm_adf_result)</span>
<span id="cb6-4"><a href="#cb6-4"></a></span>
<span id="cb6-5"><a href="#cb6-5"></a>hm_adf_teststat <span class="ot">&lt;-</span> <span class="fu">round</span>(hm_adf_result_sum<span class="sc">@</span>teststat[<span class="dv">1</span>], <span class="dv">2</span>)</span>
<span id="cb6-6"><a href="#cb6-6"></a>hm_adf_cval <span class="ot">&lt;-</span> <span class="fu">round</span>(hm_adf_result_sum<span class="sc">@</span>cval[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#KPSS test</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>hm_kpss_result <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(<span class="fu">na.omit</span>(housingdata<span class="sc">$</span>house_mel))</span>
<span id="cb6-10"><a href="#cb6-10"></a>hm_kpss_pval <span class="ot">&lt;-</span> <span class="fu">round</span>(hm_kpss_result<span class="sc">$</span>p.value, <span class="dv">2</span>)</span>
<span id="cb6-11"><a href="#cb6-11"></a></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co"># ADF test (am_ stands for apartments melbourne)</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>am_adf_result <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(housingdata<span class="sc">$</span>appt_mel, <span class="at">type =</span> <span class="st">"drift"</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>) </span>
<span id="cb6-14"><a href="#cb6-14"></a>am_adf_result_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(am_adf_result)</span>
<span id="cb6-15"><a href="#cb6-15"></a></span>
<span id="cb6-16"><a href="#cb6-16"></a>am_adf_teststat <span class="ot">&lt;-</span> <span class="fu">round</span>(am_adf_result_sum<span class="sc">@</span>teststat[<span class="dv">1</span>], <span class="dv">2</span>)</span>
<span id="cb6-17"><a href="#cb6-17"></a>am_adf_cval <span class="ot">&lt;-</span> <span class="fu">round</span>(am_adf_result_sum<span class="sc">@</span>cval[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb6-18"><a href="#cb6-18"></a></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co">#KPSS test</span></span>
<span id="cb6-20"><a href="#cb6-20"></a>am_kpss_result <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(<span class="fu">na.omit</span>(housingdata<span class="sc">$</span>appt_mel))</span>
<span id="cb6-21"><a href="#cb6-21"></a>am_kpss_pval <span class="ot">&lt;-</span> <span class="fu">round</span>(am_kpss_result<span class="sc">$</span>p.value, <span class="dv">2</span>)</span>
<span id="cb6-22"><a href="#cb6-22"></a></span>
<span id="cb6-23"><a href="#cb6-23"></a><span class="co"># ADF test (hs_ stands for houses sydney)</span></span>
<span id="cb6-24"><a href="#cb6-24"></a>hs_adf_result <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(housingdata<span class="sc">$</span>house_syd, <span class="at">type =</span> <span class="st">"drift"</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>) </span>
<span id="cb6-25"><a href="#cb6-25"></a>hs_adf_result_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(hs_adf_result)</span>
<span id="cb6-26"><a href="#cb6-26"></a></span>
<span id="cb6-27"><a href="#cb6-27"></a>hs_adf_teststat <span class="ot">&lt;-</span> <span class="fu">round</span>(hs_adf_result_sum<span class="sc">@</span>teststat[<span class="dv">1</span>], <span class="dv">2</span>)</span>
<span id="cb6-28"><a href="#cb6-28"></a>hs_adf_cval <span class="ot">&lt;-</span> <span class="fu">round</span>(hs_adf_result_sum<span class="sc">@</span>cval[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb6-29"><a href="#cb6-29"></a></span>
<span id="cb6-30"><a href="#cb6-30"></a><span class="co">#KPSS test</span></span>
<span id="cb6-31"><a href="#cb6-31"></a>hs_kpss_result <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(<span class="fu">na.omit</span>(housingdata<span class="sc">$</span>house_syd))</span>
<span id="cb6-32"><a href="#cb6-32"></a>hs_kpss_pval <span class="ot">&lt;-</span> <span class="fu">round</span>(hs_kpss_result<span class="sc">$</span>p.value, <span class="dv">2</span>)</span>
<span id="cb6-33"><a href="#cb6-33"></a></span>
<span id="cb6-34"><a href="#cb6-34"></a><span class="co"># ADF test (as_ stands for apartments sydney)</span></span>
<span id="cb6-35"><a href="#cb6-35"></a>as_adf_result <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(housingdata<span class="sc">$</span>appt_syd, <span class="at">type =</span> <span class="st">"drift"</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>) </span>
<span id="cb6-36"><a href="#cb6-36"></a>as_adf_result_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(as_adf_result)</span>
<span id="cb6-37"><a href="#cb6-37"></a></span>
<span id="cb6-38"><a href="#cb6-38"></a>as_adf_teststat <span class="ot">&lt;-</span> <span class="fu">round</span>(as_adf_result_sum<span class="sc">@</span>teststat[<span class="dv">1</span>], <span class="dv">2</span>)</span>
<span id="cb6-39"><a href="#cb6-39"></a>as_adf_cval <span class="ot">&lt;-</span> <span class="fu">round</span>(as_adf_result_sum<span class="sc">@</span>cval[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb6-40"><a href="#cb6-40"></a></span>
<span id="cb6-41"><a href="#cb6-41"></a><span class="co">#KPSS test</span></span>
<span id="cb6-42"><a href="#cb6-42"></a>as_kpss_result <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(<span class="fu">na.omit</span>(housingdata<span class="sc">$</span>appt_syd))</span>
<span id="cb6-43"><a href="#cb6-43"></a>as_kpss_pval <span class="ot">&lt;-</span> <span class="fu">round</span>(as_kpss_result<span class="sc">$</span>p.value, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Create summary table of stationarity tests</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>stationarity_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"ADF Test Stat"</span>, <span class="st">"ADF Result"</span>, <span class="st">"KPSS p-value"</span>, <span class="st">"KPSS Result"</span>),</span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="at">House_mel =</span> <span class="fu">c</span>(hm_adf_teststat, <span class="st">"Fail to reject"</span>, hm_kpss_pval, <span class="st">"Reject"</span>),</span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="at">Appt_mel =</span> <span class="fu">c</span>(am_adf_teststat, <span class="st">"Fail to reject"</span>, am_kpss_pval, <span class="st">"Reject"</span>),</span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="at">House_syd =</span> <span class="fu">c</span>(hs_adf_teststat, <span class="st">"Fail to reject"</span>, hs_kpss_pval, <span class="st">"Reject"</span>),</span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="at">Appt_syd =</span> <span class="fu">c</span>(as_adf_teststat, <span class="st">"Fail to reject"</span>, as_kpss_pval, <span class="st">"Reject"</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a>)</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a>stationarity_summary <span class="sc">|&gt;</span> </span>
<span id="cb7-11"><a href="#cb7-11"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb7-12"><a href="#cb7-12"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb7-13"><a href="#cb7-13"></a>    <span class="at">caption =</span> <span class="st">"Stationarity Test Results Summary"</span></span>
<span id="cb7-14"><a href="#cb7-14"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Stationarity Test Results Summary</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">House_mel</th>
<th style="text-align: left;">Appt_mel</th>
<th style="text-align: left;">House_syd</th>
<th style="text-align: left;">Appt_syd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ADF Test Stat</td>
<td style="text-align: left;">-0.6</td>
<td style="text-align: left;">-1.35</td>
<td style="text-align: left;">1.07</td>
<td style="text-align: left;">-0.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADF Result</td>
<td style="text-align: left;">Fail to reject</td>
<td style="text-align: left;">Fail to reject</td>
<td style="text-align: left;">Fail to reject</td>
<td style="text-align: left;">Fail to reject</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KPSS p-value</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
<td style="text-align: left;">0.01</td>
</tr>
<tr class="even">
<td style="text-align: left;">KPSS Result</td>
<td style="text-align: left;">Reject</td>
<td style="text-align: left;">Reject</td>
<td style="text-align: left;">Reject</td>
<td style="text-align: left;">Reject</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The ADF test null is that the series is non-stationary and thus has a unit root. This test is left sided with the null being rejected if the ADF test statistic is less than the critical value. The critical value at the <span class="math inline">\(5\%\)</span> level is <span class="math inline">\(-2.89\)</span>. As all the test statistics are greater than the critical value, there is insufficient evidence to reject the null, thus conclude insufficient evidence to suggest stationarity in any of the series.</p>
<p>The KPSS test is a reversal of the ADF test, where the null is that the series is stationary, and the alternative is non-stationarity. For this test a <span class="math inline">\(p\)</span>-value is given for its simplicity, where a <span class="math inline">\(p\)</span>-value less than <span class="math inline">\(0.05\)</span> results in a rejection. As all <span class="math inline">\(p\)</span>-values are <span class="math inline">\(0.01\)</span>, the conclusion is that the series are all non-stationary, which supports the conclusion from the ADF.</p>
<p>All series are determined to be non-stationary and have unit roots. According to the PACF’s, all are <span class="math inline">\(I(1)\)</span> - first order integrated – meaning that taking the first difference of each series should make each stationary.</p>
</section>
</section>
<section id="first-difference-series" class="level2">
<h2 class="anchored" data-anchor-id="first-difference-series">First Difference Series</h2>
<section id="differenced-series-plots" class="level3">
<h3 class="anchored" data-anchor-id="differenced-series-plots">Differenced Series Plots</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>housingdata_diff <span class="ot">&lt;-</span> housingdata <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-3"><a href="#cb8-3"></a>    <span class="at">house_mel =</span> <span class="fu">difference</span>(house_mel),</span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="at">appt_mel =</span> <span class="fu">difference</span>(appt_mel),</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="at">house_syd =</span> <span class="fu">difference</span>(house_syd),</span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="at">appt_syd =</span> <span class="fu">difference</span>(appt_syd)</span>
<span id="cb8-7"><a href="#cb8-7"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">drop_na</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>housingdata_diff <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>house_mel)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Price"</span>, <span class="at">title=</span><span class="st">'Melbourne Differenced Median House Prices Over Time'</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb9-5"><a href="#cb9-5"></a>housingdata_diff <span class="sc">|&gt;</span> </span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>appt_mel)) <span class="sc">+</span> </span>
<span id="cb9-7"><a href="#cb9-7"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Price"</span>, <span class="at">title=</span><span class="st">'Melbourne Differenced Median Apartment Prices Over Time'</span>) <span class="sc">+</span> </span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb9-9"><a href="#cb9-9"></a>housingdata_diff <span class="sc">|&gt;</span> </span>
<span id="cb9-10"><a href="#cb9-10"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>house_syd)) <span class="sc">+</span> </span>
<span id="cb9-11"><a href="#cb9-11"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Price"</span>, <span class="at">title=</span><span class="st">'Sydney Differenced Median House Prices Over Time'</span>) <span class="sc">+</span> </span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb9-13"><a href="#cb9-13"></a>housingdata_diff <span class="sc">|&gt;</span> </span>
<span id="cb9-14"><a href="#cb9-14"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>appt_syd)) <span class="sc">+</span> </span>
<span id="cb9-15"><a href="#cb9-15"></a>    <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Date"</span>, <span class="at">y=</span><span class="st">"Price"</span>, <span class="at">title=</span><span class="st">'Sydney Differenced Median Apartment Prices Over Time'</span>) <span class="sc">+</span> </span>
<span id="cb9-16"><a href="#cb9-16"></a>    <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2" title="Plot data" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
</div>
</div>
<p>The series of the first order differences looks stationary as there is a constant mean of <span class="math inline">\(0\)</span> across time and displays mean reverting behaviour. There are no obvious trends nor seasonality, however there appears to be a period of high volatility from <span class="math inline">\(2015\)</span> to roughly <span class="math inline">\(2018\)</span> on all plots.</p>
</section>
</section>
<section id="differenced-series-acfs" class="level2">
<h2 class="anchored" data-anchor-id="differenced-series-acfs">Differenced series ACF’s</h2>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>housingdata_diff <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">ACF</span>(house_mel) <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"ACF"</span>, <span class="at">title=</span><span class="st">"ACF of Differenced Melbourne Housing data"</span>)</span>
<span id="cb10-5"><a href="#cb10-5"></a>housingdata_diff <span class="sc">|&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">ACF</span>(appt_mel) <span class="sc">|&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"ACF"</span>, <span class="at">title=</span><span class="st">"ACF of Differenced Melbourne Apartment data"</span>)</span>
<span id="cb10-9"><a href="#cb10-9"></a>housingdata_diff <span class="sc">|&gt;</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fu">ACF</span>(house_syd) <span class="sc">|&gt;</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"ACF"</span>, <span class="at">title=</span><span class="st">"ACF of Differenced Sydney Housing data"</span>)</span>
<span id="cb10-13"><a href="#cb10-13"></a>housingdata_diff <span class="sc">|&gt;</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>  <span class="fu">ACF</span>(appt_syd) <span class="sc">|&gt;</span></span>
<span id="cb10-15"><a href="#cb10-15"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"ACF"</span>, <span class="at">title=</span><span class="st">"ACF of Differenced Sydney Apartment data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2" title="Plot differenced ACFs" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
</div>
</div>
</section>
<section id="differenced-series-pacfs" class="level2">
<h2 class="anchored" data-anchor-id="differenced-series-pacfs">Differenced series PACF’s</h2>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>housingdata_diff <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">PACF</span>(house_mel) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"PACF"</span>, <span class="at">title=</span><span class="st">"PACF of Differenced Melbourne Housing data"</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a>housingdata_diff <span class="sc">|&gt;</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">PACF</span>(appt_mel) <span class="sc">|&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"PACF"</span>, <span class="at">title=</span><span class="st">"PACF of Differenced Melbourne Apartment data"</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a>housingdata_diff <span class="sc">|&gt;</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="fu">PACF</span>(house_syd) <span class="sc">|&gt;</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"PACF"</span>, <span class="at">title=</span><span class="st">"PACF of Differenced Sydney Housing data"</span>)</span>
<span id="cb11-13"><a href="#cb11-13"></a>housingdata_diff <span class="sc">|&gt;</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>  <span class="fu">PACF</span>(appt_syd) <span class="sc">|&gt;</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>  <span class="fu">autoplot</span>() <span class="sc">+</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Lag"</span>, <span class="at">y=</span><span class="st">"PACF"</span>, <span class="at">title=</span><span class="st">"PACF of Differenced Sydney Apartment data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell quarto-layout-panel" data-layout-ncol="2" title="Plot differenced PACFs" data-layout-nrow="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Assignment2_files/figure-html/unnamed-chunk-11-4.png" class="img-fluid" data-fig-pos="H" width="672"></p>
</div>
</div>
</div>
<p>Looking at the ACF’s and PACF’s, the series have strange patterns, but this won’t be a problem. With the ACF’s, there’s a big spike at lag <span class="math inline">\(1\)</span>, then all others hover near <span class="math inline">\(0\)</span> with few small spikes spread out. With the PACF’s there are small spikes at early lags and then some random fluctuations. This is consistent with stationary processes with short memory; these series likely have an <span class="math inline">\(\text{AR}(1)\)</span> component as previously mentioned.</p>
<p>The ACF’s show a strong positive first lag correlation, which indicates short run persistence, or momentum, in price changes. This is typical of housing markets and for a model such as a VAR, is captured by adding a lag.</p>
<p>The PACF’s display oscillating behaviour. This means that there are small corrections in price changes, for example, price changes this quarter are positively related to the last quarter’s changes but then negatively related to the second lag, which is the correction. This is expected of housing markets as when prices start to rise they might rise for a short time, but then the rate of change would slow down likely due to affordability issues.</p>
<p>Overall, the behaviour of the ACF’s and PACF’s will not cause any issues, provided that the series are all stationary, which we demonstrate using ADF and KPSS tests again.</p>
</section>
<section id="formal-hypothesis-tests-to-determine-stationarity-adf-and-kpss-1" class="level2">
<h2 class="anchored" data-anchor-id="formal-hypothesis-tests-to-determine-stationarity-adf-and-kpss-1">Formal Hypothesis tests to determine stationarity (ADF and KPSS):</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># ADF test (hm_ stands for homes melbourne)</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>hm_diff_adf_result <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(housingdata_diff<span class="sc">$</span>house_mel, <span class="at">type =</span> <span class="st">"drift"</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>) </span>
<span id="cb12-3"><a href="#cb12-3"></a>hm_diff_adf_result_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(hm_diff_adf_result)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a>hm_diff_adf_teststat <span class="ot">&lt;-</span> <span class="fu">round</span>(hm_diff_adf_result_sum<span class="sc">@</span>teststat[<span class="dv">1</span>], <span class="dv">2</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>hm_diff_adf_cval <span class="ot">&lt;-</span> <span class="fu">round</span>(hm_diff_adf_result_sum<span class="sc">@</span>cval[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#KPSS test</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>hm_diff_kpss_result <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(<span class="fu">na.omit</span>(housingdata_diff<span class="sc">$</span>house_mel))</span>
<span id="cb12-10"><a href="#cb12-10"></a>hm_diff_kpss_pval <span class="ot">&lt;-</span> <span class="fu">round</span>(hm_diff_kpss_result<span class="sc">$</span>p.value, <span class="dv">2</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co"># ADF test (am_ stands for apartments melbourne)</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>am_diff_adf_result <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(housingdata_diff<span class="sc">$</span>appt_mel, <span class="at">type =</span> <span class="st">"drift"</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>) </span>
<span id="cb12-14"><a href="#cb12-14"></a>am_diff_adf_result_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(am_diff_adf_result)</span>
<span id="cb12-15"><a href="#cb12-15"></a></span>
<span id="cb12-16"><a href="#cb12-16"></a>am_diff_adf_teststat <span class="ot">&lt;-</span> <span class="fu">round</span>(am_diff_adf_result_sum<span class="sc">@</span>teststat[<span class="dv">1</span>], <span class="dv">2</span>)</span>
<span id="cb12-17"><a href="#cb12-17"></a>am_diff_adf_cval <span class="ot">&lt;-</span> <span class="fu">round</span>(am_diff_adf_result_sum<span class="sc">@</span>cval[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb12-18"><a href="#cb12-18"></a></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co">#KPSS test</span></span>
<span id="cb12-20"><a href="#cb12-20"></a>am_diff_kpss_result <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(<span class="fu">na.omit</span>(housingdata_diff<span class="sc">$</span>appt_mel))</span>
<span id="cb12-21"><a href="#cb12-21"></a>am_diff_kpss_pval <span class="ot">&lt;-</span> <span class="fu">round</span>(am_diff_kpss_result<span class="sc">$</span>p.value, <span class="dv">2</span>)</span>
<span id="cb12-22"><a href="#cb12-22"></a></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co"># ADF test (hs_ stands for houses sydney)</span></span>
<span id="cb12-24"><a href="#cb12-24"></a>hs_diff_adf_result <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(housingdata_diff<span class="sc">$</span>house_syd, <span class="at">type =</span> <span class="st">"drift"</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>) </span>
<span id="cb12-25"><a href="#cb12-25"></a>hs_diff_adf_result_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(hs_diff_adf_result)</span>
<span id="cb12-26"><a href="#cb12-26"></a></span>
<span id="cb12-27"><a href="#cb12-27"></a>hs_diff_adf_teststat <span class="ot">&lt;-</span> <span class="fu">round</span>(hs_diff_adf_result_sum<span class="sc">@</span>teststat[<span class="dv">1</span>], <span class="dv">2</span>)</span>
<span id="cb12-28"><a href="#cb12-28"></a>hs_diff_adf_cval <span class="ot">&lt;-</span> <span class="fu">round</span>(hs_diff_adf_result_sum<span class="sc">@</span>cval[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb12-29"><a href="#cb12-29"></a></span>
<span id="cb12-30"><a href="#cb12-30"></a><span class="co">#KPSS test</span></span>
<span id="cb12-31"><a href="#cb12-31"></a>hs_diff_kpss_result <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(<span class="fu">na.omit</span>(housingdata_diff<span class="sc">$</span>house_syd))</span>
<span id="cb12-32"><a href="#cb12-32"></a>hs_diff_kpss_pval <span class="ot">&lt;-</span> <span class="fu">round</span>(hs_diff_kpss_result<span class="sc">$</span>p.value, <span class="dv">2</span>)</span>
<span id="cb12-33"><a href="#cb12-33"></a></span>
<span id="cb12-34"><a href="#cb12-34"></a><span class="co"># ADF test (as_ stands for apartments sydney)</span></span>
<span id="cb12-35"><a href="#cb12-35"></a>as_diff_adf_result <span class="ot">&lt;-</span> <span class="fu">ur.df</span>(housingdata_diff<span class="sc">$</span>appt_syd, <span class="at">type =</span> <span class="st">"drift"</span>, <span class="at">selectlags =</span> <span class="st">"AIC"</span>) </span>
<span id="cb12-36"><a href="#cb12-36"></a>as_diff_adf_result_sum <span class="ot">&lt;-</span> <span class="fu">summary</span>(as_diff_adf_result)</span>
<span id="cb12-37"><a href="#cb12-37"></a></span>
<span id="cb12-38"><a href="#cb12-38"></a>as_diff_adf_teststat <span class="ot">&lt;-</span> <span class="fu">round</span>(as_diff_adf_result_sum<span class="sc">@</span>teststat[<span class="dv">1</span>], <span class="dv">2</span>)</span>
<span id="cb12-39"><a href="#cb12-39"></a>as_diff_adf_cval <span class="ot">&lt;-</span> <span class="fu">round</span>(as_diff_adf_result_sum<span class="sc">@</span>cval[<span class="dv">1</span>,<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb12-40"><a href="#cb12-40"></a></span>
<span id="cb12-41"><a href="#cb12-41"></a><span class="co">#KPSS test</span></span>
<span id="cb12-42"><a href="#cb12-42"></a>as_diff_kpss_result <span class="ot">&lt;-</span> <span class="fu">kpss.test</span>(<span class="fu">na.omit</span>(housingdata_diff<span class="sc">$</span>appt_syd))</span>
<span id="cb12-43"><a href="#cb12-43"></a>as_diff_kpss_pval <span class="ot">&lt;-</span> <span class="fu">round</span>(as_diff_kpss_result<span class="sc">$</span>p.value, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Create summary table of stationarity tests</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>stationarity_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"ADF Test Stat"</span>, <span class="st">"ADF Result"</span>, <span class="st">"KPSS p-value"</span>, <span class="st">"KPSS Result"</span>),</span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="at">House_mel =</span> <span class="fu">c</span>(hm_diff_adf_teststat, <span class="st">"Reject"</span>, hm_diff_kpss_pval, <span class="st">"Fail to Reject"</span>),</span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="at">Appt_mel =</span> <span class="fu">c</span>(am_diff_adf_teststat, <span class="st">"Reject"</span>, am_diff_kpss_pval, <span class="st">"Fail to Reject"</span>),</span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="at">House_syd =</span> <span class="fu">c</span>(hs_diff_adf_teststat, <span class="st">"Reject"</span>, hs_diff_kpss_pval, <span class="st">"Fail to Reject"</span>),</span>
<span id="cb13-7"><a href="#cb13-7"></a>  <span class="at">Appt_syd =</span> <span class="fu">c</span>(as_diff_adf_teststat, <span class="st">"Reject"</span>, as_diff_kpss_pval, <span class="st">"Fail to Reject"</span>)</span>
<span id="cb13-8"><a href="#cb13-8"></a>)</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a>stationarity_summary <span class="sc">|&gt;</span> </span>
<span id="cb13-11"><a href="#cb13-11"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb13-12"><a href="#cb13-12"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb13-13"><a href="#cb13-13"></a>    <span class="at">caption =</span> <span class="st">"Stationarity Test Results Summary"</span>,</span>
<span id="cb13-14"><a href="#cb13-14"></a>    <span class="at">col.names =</span> stationarity_summary <span class="sc">|&gt;</span> </span>
<span id="cb13-15"><a href="#cb13-15"></a>      <span class="fu">names</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>      <span class="fu">imap</span>(\(x, idx) <span class="fu">ifelse</span>(idx<span class="sc">&gt;</span><span class="dv">1</span>, <span class="fu">paste0</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">texttt{"</span>, x, <span class="st">"}$"</span>) <span class="sc">|&gt;</span> <span class="fu">str_replace_all</span>(<span class="fu">fixed</span>(<span class="st">"_"</span>), <span class="fu">fixed</span>(<span class="st">"</span><span class="sc">\\</span><span class="st">_"</span>)), x))</span>
<span id="cb13-17"><a href="#cb13-17"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Stationarity Test Results Summary</caption>
<colgroup>
<col style="width: 14%">
<col style="width: 22%">
<col style="width: 21%">
<col style="width: 22%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;"><span class="math inline">\(\texttt{House\_mel}\)</span></th>
<th style="text-align: left;"><span class="math inline">\(\texttt{Appt\_mel}\)</span></th>
<th style="text-align: left;"><span class="math inline">\(\texttt{House\_syd}\)</span></th>
<th style="text-align: left;"><span class="math inline">\(\texttt{Appt\_syd}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ADF Test Stat</td>
<td style="text-align: left;">-5.13</td>
<td style="text-align: left;">-4.87</td>
<td style="text-align: left;">-4.61</td>
<td style="text-align: left;">-5.26</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADF Result</td>
<td style="text-align: left;">Reject</td>
<td style="text-align: left;">Reject</td>
<td style="text-align: left;">Reject</td>
<td style="text-align: left;">Reject</td>
</tr>
<tr class="odd">
<td style="text-align: left;">KPSS p-value</td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">KPSS Result</td>
<td style="text-align: left;">Fail to Reject</td>
<td style="text-align: left;">Fail to Reject</td>
<td style="text-align: left;">Fail to Reject</td>
<td style="text-align: left;">Fail to Reject</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The results of these tests are the opposite of the earlier results. As a reminder, the ADF null is that the series is non-stationary, and the KPSS null is that the series is stationary.</p>
<p>As the null is rejected in all ADF tests (test statistics are less than the critical value of <span class="math inline">\(-2.89\)</span>), this leads to the conclusion that the series are all stationary. This is further supported by the KPSS nulls not having enough evidence to reject them. Thus, the conclusion is that the differenced series are all stationary and can be modelled. This conclusion also supports the earlier theory that the series are <span class="math inline">\(I(1)\)</span>, as the series became stationary after the first difference.</p>
</section>
</section>
<section id="cointegration-relationships" class="level1">
<h1>Cointegration Relationships</h1>
<section id="formal-tests" class="level2">
<h2 class="anchored" data-anchor-id="formal-tests">Formal Tests</h2>
<p>As the variables all relate to property markets in the two biggest Australian cities, it might be possible that cointegrating relationships exist.</p>
<p>If two or more variables (e.g.&nbsp;housing prices and apartment prices in Melbourne) are both I(1) as established in the previous section, it possible that they can still move together to reach a certain long run equilibrium. Economically, this reflects a market tie such as substitute products for houses and apartments that mean these series move together in the long run.</p>
<p>Cointegration implies that though the variables are non-stationary in levels by themselves, there may be a long run equilibrium relationship.</p>
<section id="engle---granger-test" class="level3">
<h3 class="anchored" data-anchor-id="engle---granger-test">Engle - Granger Test</h3>
<p>The Engle-Granger procedure was conducted to test four possible pairs.</p>
<p>This is a test conducted on the long run regressions of each series on their pair.</p>
<p>For example, let <span class="math inline">\(y_t\)</span> be median house prices in Melb and let <span class="math inline">\(x\)</span> be house prices in Sydney.<br>
Thus, the long run regression is</p>
<p><span class="math display">\[
y_t = c + \beta x_t + u_t
\]</span></p>
<p>An ADF test is then run on the residuals <span class="math inline">\(u_t\)</span> of this regression. There is cointegration if the residuals are <span class="math inline">\(I(0)\)</span>, i.e.&nbsp;if the ADF null is rejected.</p>
<p>Here are the results:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>hm_hs_test <span class="ot">&lt;-</span> housingdata <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">lm</span>(house_mel <span class="sc">~</span> house_syd, <span class="at">data =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="fu">adf.test</span>()</span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a>hm_hs_p_val <span class="ot">&lt;-</span> hm_hs_test <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="st">"p.value"</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a>am_as_test <span class="ot">&lt;-</span> housingdata <span class="sc">|&gt;</span> </span>
<span id="cb14-9"><a href="#cb14-9"></a>  <span class="fu">lm</span>(appt_mel <span class="sc">~</span> appt_syd, <span class="at">data =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>  <span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>  <span class="fu">adf.test</span>()</span>
<span id="cb14-12"><a href="#cb14-12"></a></span>
<span id="cb14-13"><a href="#cb14-13"></a>am_as_p_val <span class="ot">&lt;-</span> am_as_test <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="st">"p.value"</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb14-14"><a href="#cb14-14"></a></span>
<span id="cb14-15"><a href="#cb14-15"></a>am_hm_test <span class="ot">&lt;-</span> housingdata <span class="sc">|&gt;</span> </span>
<span id="cb14-16"><a href="#cb14-16"></a>  <span class="fu">lm</span>(house_mel <span class="sc">~</span> appt_mel, <span class="at">data =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb14-17"><a href="#cb14-17"></a>  <span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-18"><a href="#cb14-18"></a>  <span class="fu">adf.test</span>()</span>
<span id="cb14-19"><a href="#cb14-19"></a></span>
<span id="cb14-20"><a href="#cb14-20"></a>am_hm_p_val <span class="ot">&lt;-</span> am_hm_test <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="st">"p.value"</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb14-21"><a href="#cb14-21"></a></span>
<span id="cb14-22"><a href="#cb14-22"></a>as_hs_test <span class="ot">&lt;-</span> housingdata <span class="sc">|&gt;</span> </span>
<span id="cb14-23"><a href="#cb14-23"></a>  <span class="fu">lm</span>(house_syd <span class="sc">~</span> appt_syd, <span class="at">data =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb14-24"><a href="#cb14-24"></a>  <span class="fu">residuals</span>() <span class="sc">|&gt;</span></span>
<span id="cb14-25"><a href="#cb14-25"></a>  <span class="fu">adf.test</span>()</span>
<span id="cb14-26"><a href="#cb14-26"></a></span>
<span id="cb14-27"><a href="#cb14-27"></a>as_hs_p_val <span class="ot">&lt;-</span> as_hs_test <span class="sc">|&gt;</span> <span class="fu">pluck</span>(<span class="st">"p.value"</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="at">Relationship =</span> <span class="fu">c</span>(</span>
<span id="cb15-3"><a href="#cb15-3"></a>    <span class="st">"House prices in Melb and Syd"</span>,</span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="st">"Apartment prices in Melb and Syd "</span>,</span>
<span id="cb15-5"><a href="#cb15-5"></a>    <span class="st">"Apartment prices and House prices in Melb"</span>, </span>
<span id="cb15-6"><a href="#cb15-6"></a>    <span class="st">"Apartment prices and House prices in Syd"</span> </span>
<span id="cb15-7"><a href="#cb15-7"></a>    ),</span>
<span id="cb15-8"><a href="#cb15-8"></a>  <span class="st">"P Value"</span> <span class="ot">=</span> <span class="fu">c</span>(hm_hs_p_val, am_as_p_val, am_hm_p_val, as_hs_p_val),</span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="at">Result =</span> <span class="fu">rep</span>(<span class="st">"Failed to Reject $H_0$"</span>, <span class="dv">4</span>)</span>
<span id="cb15-10"><a href="#cb15-10"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb15-11"><a href="#cb15-11"></a>  (\(table) knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb15-12"><a href="#cb15-12"></a>    table,</span>
<span id="cb15-13"><a href="#cb15-13"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb15-14"><a href="#cb15-14"></a>    <span class="at">caption =</span> <span class="st">"Engle Granger Cointegration Test"</span>,</span>
<span id="cb15-15"><a href="#cb15-15"></a>    <span class="at">col.names =</span> <span class="fu">names</span>(table) <span class="sc">|&gt;</span> </span>
<span id="cb15-16"><a href="#cb15-16"></a>      <span class="fu">map</span>(\(x) <span class="fu">str_replace_all</span>(x, <span class="fu">fixed</span>(<span class="st">"."</span>), <span class="st">" "</span>))</span>
<span id="cb15-17"><a href="#cb15-17"></a>  ))()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Engle Granger Cointegration Test</caption>
<colgroup>
<col style="width: 57%">
<col style="width: 10%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Relationship</th>
<th style="text-align: right;">P Value</th>
<th style="text-align: left;">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">House prices in Melb and Syd</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: left;">Failed to Reject <span class="math inline">\(H_0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Apartment prices in Melb and Syd</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: left;">Failed to Reject <span class="math inline">\(H_0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Apartment prices and House prices in Melb</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: left;">Failed to Reject <span class="math inline">\(H_0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Apartment prices and House prices in Syd</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: left;">Failed to Reject <span class="math inline">\(H_0\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For all the tested pairs, there was insufficient evidence to reject <span class="math inline">\(H_0\)</span>. Thus, there is no evidence of cointegration with any pair. The series only move together in the short run and don’t move around a common long run equilibrium.</p>
</section>
<section id="johansen-test" class="level3">
<h3 class="anchored" data-anchor-id="johansen-test">Johansen Test</h3>
<p>The Johansen test is used to detect whether a group of <span class="math inline">\(I(1)\)</span> variables are cointegrated, i.e.&nbsp;whether there is one or more long-run equilibrium relationships.</p>
<p>The Vector Error Correction Model that was used will look like the below:</p>
<p><span class="math display">\[
\Delta \mathbf{y_{t}}=\mathbf{\alpha\beta'y_{t-1}} + \mathbf{\Gamma_{1}\Delta y_{t-1}}+\mathbf{D_{t}} + \mathbf{\varepsilon_{t}}
\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\mathbf{y_{t}} =\begin{bmatrix} \texttt{house\_mel} &amp;  \texttt{house\_syd} &amp; \texttt{appt\_mel} &amp; \texttt{appt\_syd} \end{bmatrix}^{T}\)</span><br>
</li>
<li><span class="math inline">\(\mathbf{\Delta y_{t}} = \mathbf{y_{t}}-\mathbf{y_{t-1}}\)</span> is the differenced series<br>
</li>
<li><span class="math inline">\(\mathbf{\alpha} \in \mathbb{R}^{4\times r}\)</span> is the “adjustment” matrix (response to disequilibrium)<br>
</li>
<li><span class="math inline">\(\mathbf{\beta} \in\mathbb{R}^{4\times r}\)</span> is the “cointegrating vector” matrix (strength of the cointegrating relationships)<br>
</li>
<li><span class="math inline">\(\mathbf{D_{t}}\in\mathbb{R}^{4\times1}\)</span> includes the constant and seasonal components<br>
</li>
<li><span class="math inline">\(\mathbf{\Gamma_{1}}\in\mathbb{R}^{4\times4}\)</span> are the short run dynamics from lagged differences<br>
</li>
<li><span class="math inline">\(r=\text{rank}(\mathbf{\alpha\beta'})\)</span></li>
</ul>
<p>The existence of cointegration in these variables depend on matrix “rank” of the <span class="math inline">\(\mathbf{\alpha\beta'}\)</span> matrix, which is denoted as <span class="math inline">\(\mathbf\Pi\)</span>. In the Johansen test, the rank of <span class="math inline">\(\mathbf \Pi\)</span> is given by <span class="math inline">\(r\)</span>, which will determine the number of cointegrating relationships.</p>
<p>This test was conducted as the Maximum Eigenvalue version, using a <span class="math inline">\(\text{VAR}(2)\)</span> in levels leading to <span class="math inline">\(1\)</span> lag of differences, and including quarterly seasonal dummies.</p>
<p>The reasoning behind using a <span class="math inline">\(\text{VAR}(2)\)</span> is that the series are all <span class="math inline">\(I(1)\)</span>, so only <span class="math inline">\(1\)</span> lag in differences for the VECM is necessary, as a <span class="math inline">\(\text{VAR}(2)\)</span> model collapses to a VECM with one lag.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>housing_jo_summ <span class="ot">&lt;-</span> housingdata <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(house_mel, appt_mel, house_syd, appt_syd) <span class="sc">|&gt;</span> </span>
<span id="cb16-4"><a href="#cb16-4"></a>  <span class="fu">ca.jo</span>(</span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="at">ecdet =</span> <span class="st">"const"</span>, </span>
<span id="cb16-6"><a href="#cb16-6"></a>    <span class="at">type=</span><span class="st">"eigen"</span>, </span>
<span id="cb16-7"><a href="#cb16-7"></a>    <span class="at">K =</span> <span class="dv">2</span>, </span>
<span id="cb16-8"><a href="#cb16-8"></a>    <span class="at">spec=</span><span class="st">"longrun"</span>, </span>
<span id="cb16-9"><a href="#cb16-9"></a>    <span class="at">season=</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-10"><a href="#cb16-10"></a>  <span class="fu">summary</span>() </span>
<span id="cb16-11"><a href="#cb16-11"></a></span>
<span id="cb16-12"><a href="#cb16-12"></a></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="fu">data.frame</span>(</span>
<span id="cb16-14"><a href="#cb16-14"></a>  <span class="at">Relationship =</span> <span class="fu">c</span>(<span class="st">"$r</span><span class="sc">\\</span><span class="st">leq 3$"</span>, <span class="st">"$r </span><span class="sc">\\</span><span class="st">leq 2$"</span>, <span class="st">"$r</span><span class="sc">\\</span><span class="st">leq 1$"</span>, <span class="st">"$r=0$"</span>),</span>
<span id="cb16-15"><a href="#cb16-15"></a>  <span class="st">`</span><span class="at">Test Statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">pluck</span>(housing_jo_summ, <span class="st">"teststat"</span>),</span>
<span id="cb16-16"><a href="#cb16-16"></a>  <span class="st">`</span><span class="at">Critical Value</span><span class="st">`</span> <span class="ot">=</span> housing_jo_summ <span class="sc">|&gt;</span></span>
<span id="cb16-17"><a href="#cb16-17"></a>    <span class="fu">pluck</span>(<span class="st">"cval"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-18"><a href="#cb16-18"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb16-19"><a href="#cb16-19"></a>    <span class="fu">pull</span>(<span class="dv">2</span>),</span>
<span id="cb16-20"><a href="#cb16-20"></a>  <span class="at">Result =</span> <span class="fu">rep</span>(<span class="st">"Fail to Reject"</span>, <span class="dv">4</span>)</span>
<span id="cb16-21"><a href="#cb16-21"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb16-22"><a href="#cb16-22"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb16-23"><a href="#cb16-23"></a>    <span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb16-24"><a href="#cb16-24"></a>    <span class="at">caption =</span> <span class="st">"Engle Granger Cointegration Test"</span>,</span>
<span id="cb16-25"><a href="#cb16-25"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Relationship"</span>, <span class="st">"Test Statistic"</span>, <span class="st">"Critical Value ($5</span><span class="sc">\\</span><span class="st">%$)"</span>, <span class="st">"Result"</span>)</span>
<span id="cb16-26"><a href="#cb16-26"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Engle Granger Cointegration Test</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Relationship</th>
<th style="text-align: right;">Test Statistic</th>
<th style="text-align: right;">Critical Value (<span class="math inline">\(5\%\)</span>)</th>
<th style="text-align: left;">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(r\leq 3\)</span></td>
<td style="text-align: right;">2.11</td>
<td style="text-align: right;">9.24</td>
<td style="text-align: left;">Fail to Reject</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(r \leq 2\)</span></td>
<td style="text-align: right;">5.75</td>
<td style="text-align: right;">15.67</td>
<td style="text-align: left;">Fail to Reject</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(r\leq 1\)</span></td>
<td style="text-align: right;">16.09</td>
<td style="text-align: right;">22.00</td>
<td style="text-align: left;">Fail to Reject</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(r=0\)</span></td>
<td style="text-align: right;">26.64</td>
<td style="text-align: right;">28.14</td>
<td style="text-align: left;">Fail to Reject</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The test fails to be rejected at the first rank, <span class="math inline">\(r = 0\)</span>, so it is appropriate to stop and conclude that there are no cointegrating relationships at the <span class="math inline">\(5\%\)</span> level.</p>
<p>This result supports the result from the previous Engle-Granger tests in which no cointegrating pairs were found. While there may be short run relationships, there are no stable long-run equilibrium relationships.</p>
<p>An explanation for no cross-city relationships could be due to city-specific factors such as different state jurisdictions between Melbourne and Sydney creating different property policies and laws, supply and demand differences such as land constraints and migration trends, and separate regional economies. Nation-wide factors may affect properties in both cities, but the differences in regional dynamics mean there is no shared long run equilibrium.</p>
<p>An explanation for no relationships in same-city properties could be due to different policies regarding apartments and houses, different supply dynamics, eg. apartment supply can rise fast with construction resources being allocated while house construction is much slower due to land availability. Furthermore, houses and apartments may serve different markets, such as houses for families and apartments for investors/young buyers, meaning that macroeconomic shocks may impact each market differently.</p>
</section>
</section>
<section id="implications-for-modelling" class="level2">
<h2 class="anchored" data-anchor-id="implications-for-modelling">Implications for Modelling</h2>
<p>The Johansen test was conducted using maximum eigenvalue statistics. The null of no cointegrating relationships (<span class="math inline">\(r=0\)</span>) could not be rejected at the <span class="math inline">\(5\%\)</span> significance level, suggesting that the four price series do not share any stable long-run equilibrium relationships.</p>
<p>The fact that the variables are <span class="math inline">\(I(1)\)</span> and are not cointegrated will mean a VAR model in first differences will be used to conduct impulse response analysis and discuss rezoning implications. The VAR will only capture short-run changes as no long-run relationship exists.</p>
<p>The <span class="math inline">\(\text{VAR}(1)\)</span> model is estimated as</p>
<p><span class="math display">\[
\Delta\mathbf{y_{t}}=\mathbf{c}+\mathbf{\Phi}\Delta \mathbf{y_{t-1}}+\mathbf{\varepsilon_{t}}
\]</span></p>
<p>Where</p>
<ul>
<li><span class="math inline">\(\Delta\mathbf{y_{t}} =\begin{bmatrix} \Delta\texttt{house\_mel} &amp;  \Delta\texttt{house\_syd} &amp; \Delta\texttt{appt\_mel} &amp; \Delta\texttt{appt\_syd} \end{bmatrix}^{T}\)</span><br>
</li>
<li><span class="math inline">\(c\in\mathbb{R}^{4\times1}\)</span> is the intercept vector<br>
</li>
<li><span class="math inline">\(\mathbf{\Phi}\in\mathbb{R}^{4\times4}\)</span> is the coefficients matrix</li>
</ul>
<p>To further illustrate, the first equation will be: <span class="math display">\[
\begin{aligned}
\Delta\texttt{house\_mel}_{t} = c_{1} &amp; +\alpha_{1,1}\Delta\texttt{house\_mel}_{t-1} \\
&amp; + \alpha_{1,2}\Delta\texttt{appt\_mel}_{t-1} \\
&amp; + \alpha_{1,3}\Delta\texttt{house\_syd}_{t-1} \\
&amp; + \alpha_{1,4}\Delta\texttt{appt\_mel}_{t-1} \\
&amp; + \varepsilon_{1,t}
\end{aligned}
\]</span></p>
<p>Which tells us that quarterly change in Melbourne house prices depends on:</p>
<ul>
<li>Its own past change (momentum)<br>
</li>
<li>Past change in Melbourne apartments (substitution effects)<br>
</li>
<li>Past growth in Sydney houses and apartments (cross-city spillovers)<br>
</li>
<li>Random shocks (policy, interest rates)</li>
</ul>
<p>This model will capture short run relationships and model how changes in each property series are affected by past changes in the others.</p>
<section id="what-if-there-was-one-or-more-cointgrating-relationship" class="level3">
<h3 class="anchored" data-anchor-id="what-if-there-was-one-or-more-cointgrating-relationship">What if There Was One or More Cointgrating Relationship</h3>
<p>If the Johansen test had different parameters, it is possible that it would conclude that there is one or more cointegrating relationship. Though the test would be mis-specified, it is worth noting the implications for modelling if this was the case.</p>
<p>If the variables are all <span class="math inline">\(I(1)\)</span> but are cointegrated it means:</p>
<ul>
<li>There is a long-run equilibrium relationship, as in a linear combination of the variables in stationary <span class="math inline">\(I(0)\)</span><br>
</li>
<li>Even though the series can have short term differences, they move together in the long run and deviations from the equilibrium are gradually corrected</li>
</ul>
<p>Economically this means that prices in different housing markets move together over time, they don’t drift apart forever. As in if Melbourne apartments and houses are cointegrated then over time if houses rise too far above apartment prices they eventually adjust back to a long run ratio.</p>
<p>Regarding the model itself, instead of a <span class="math inline">\(\text{VAR}(1)\)</span>, a Vector Error Correction VECM model would be used, in this case a <span class="math inline">\(\text{VECM}(1)\)</span>, with its model form being the same as what was discussed for the Johansen test.</p>
<p><span class="math display">\[
\Delta \mathbf{y_{t}}=\mathbf{\alpha\beta'y_{t-1}} + \mathbf{\Gamma_{1}\Delta y_{t-1}}+\mathbf{D_{t}} + \mathbf{\varepsilon_{t}}
\]</span></p>
<p>The <span class="math inline">\(\mathbf{\alpha\beta'}\)</span> or <span class="math inline">\(\mathbf{\Pi}\)</span> matrix is important here as if <span class="math inline">\(\mathbf{\beta'y_{t-1}} &gt; 0\)</span> then house prices are above their long run equilibrium relative to apartments, so the coefficient <span class="math inline">\(\alpha_1\)</span> will have to correct the market downwards the next period, meaning <span class="math inline">\(\alpha_1\)</span> will be negative.</p>
<p>The long run equilibrium will restore itself through short run dynamics, thus short-run dynamics and long-run equilibrium can be analysed simultaneously.</p>
</section>
</section>
</section>
<section id="impluse-response-analysis" class="level1">
<h1>Impluse Response Analysis</h1>
<section id="impulse-response-plots-for-textvar1" class="level2">
<h2 class="anchored" data-anchor-id="impulse-response-plots-for-textvar1">Impulse Response Plots for <span class="math inline">\(\text{VAR}(1)\)</span></h2>
</section>
<section id="plot-goes-here" class="level2">
<h2 class="anchored" data-anchor-id="plot-goes-here">PLOT GOES HERE</h2>
<p>We found, through a series of tests, that all four series are I(1) and that there are no cointegrating relationships. Thus, a VAR on the first differences of the four series was modelled. The variables in the VAR therefore represent quarterly changes in prices; and the IRFs show how growth rates respond to shocks (short-run effects).</p>
<p>A VAR(1) model was used to compute IRFs with 95% bootstrap CIs and 100 replications, for shocks to apartment prices in both cities.</p>
<p>The ordering of the variables was opposite city houses, opposite city apartments, local city houses, local city apartments. However, it was determined that the ordering did not matter as the same conclusions were reached with other orders</p>
<p>AIC tests generally suggested lags above 10 were better, however we have relatively few observations (81) and a high number of variables (4), meaning this would create a highly complex model. Thus, VAR(1) was chosen for its parsimony and simplicity.</p>
<p>The sample horizon was chosen as 4 quarters as it was found that the effects of shocks only took one quarter to correct. Thus, to improve readability a period of 1 year was adequate.</p>
<p>Impulse responses in the VAR were based on orthogonalised shocks. They show how each variable in the VAR reacts over time to an unexpected shock in one of the other variables. These shocks are treated as separate, one-off disturbances to each market, i.e.&nbsp;an unexpected rise in Melbourne apartment prices – while holding other shocks constant. The responses show how property price growth adjusts following that disturbance.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>