---
title: "ETC3450 — Time Series Econometrics \\newline \\newline Assignment 2"
author:
- name: Ari Gestetner
  email: ages0001@student.monash.edu
- name: Nathan Giofkou
  email: ngio0003@student.monash.edu
- name: Mitchell Evans 
  email: meva0009@student.monash.edu
organization: ETC3450
bibliography: references.bib
format:
  html:
    execute:
      echo: true
    code-fold: true
  report-pdf:
    execute:
      echo: false

execute: 
  warning: false
---

```{r}
#| eval: false

renv::load("Assignment2")
setwd("Assignment2")
```  

```{r}
library(tidyverse)
library(tsibble)
library(feasts)
library(dplyr)
library(urca)
library(tseries)

housingdata <- read_csv("./housingdata.csv")
```  

# Housing Data: Time Series Properties


## Stationarity: 

> Determine whether series are stationary (use visualisation and hypothesis tests)


```{r}
#| title: Load data

# Melb houses
housemelb_ts <- housingdata |> 
  as_tibble()|>
  mutate(date=yearquarter(date))

# Melb apartments
apptmelb_ts <- housingdata |> 
  as_tibble() |>
  mutate(date=yearquarter(date))

# Syd houses
housesyd_ts <- housingdata |> 
  as_tibble() |>
  mutate(date=yearquarter(date))

# Syd apartments
apptsyd_ts <- housingdata |> 
  as_tibble() |>
  mutate(date=yearquarter(date))
```


```{r}
#| title: Plot data
#| layout-ncol: 2
#| layout-nrow: 2

# Creating the plot
housemelb_ts |> 
  ggplot(aes(x=date,y=house_mel))+labs(x="data", y="House_mel", title='Melb Median House Prices Over Time') +
    geom_line() +
    theme_bw()

# Creating the plot
apptmelb_ts |> 
  ggplot(aes(x=date,y=appt_mel)) + 
    labs(x="data", y="appt_mel", title='Melb Median Apartment Prices Over Time') + 
    geom_line() +
    theme_bw()



# Creating the plot
housesyd_ts |> 
  ggplot(aes(x=date,y=house_syd)) + 
    labs(x="data", y="house_syd", title='Sydney Median House Prices Over Time') + 
    geom_line() +
    theme_bw()

# Creating the plot
apptsyd_ts |> 
  ggplot(aes(x=date,y=appt_syd)) + 
    labs(x="data", y="appt_syd", title='Sydney Median Apartment Prices Over Time') + 
    geom_line() +
    theme_bw()
```

Visually, all series look non-stationary as their means are clearly time dependent and all series exhibit an upwards trend. Doesn’t seem to be any seasonality.

## Formal Hypothesis tests

```{r}
#| layout-ncol: 2
#| fig-subcap: 
#|  - "Significant spike at lag $1$ in ACF indicates we use $1$ lag for an ADF test."
#|  - "The PACF has very slow decay, indicating non stationarity."

acf(housemelb_ts$house_mel)
pacf(housemelb_ts$house_mel) 

hm_adf_result <- ur.df(housemelb_ts$house_mel, type = "drift", selectlags = "AIC") #ADF test
hm_adf_result_sum <- summary(hm_adf_result)

hm_adf_teststat <- round(hm_adf_result_sum@teststat[1], 2)
hm_adf_cval <- round(hm_adf_result_sum@cval[1,2], 2)

#KPSS test
hm_kpss_result <- kpss.test(na.omit(housemelb_ts$house_mel))
hm_kpss_pval <- round(hm_kpss_result$p.value, 2)
```


For the ADF test: The $\tau$ statistic was given as $`r hm_adf_teststat`$, which is greater than the critical value of $`r hm_adf_cval`$ at the $5\%$ significance level. Thus, we fail to reject $H_0$ and conclude that the series may have a unit root and differencing is necessary.

For the KPSS test: the p-value was given as $`r hm_kpss_pval`$, so we reject the null in favour of the series being non stationary, which supports the conclusion from the ADF test.

From the PACF, the strong spike at lag $1$ suggests the presence of persistence in the series, which is consistent with non-stationary behaviour. Combined with formal unit root tests, this indicates that the series likely becomes stationary after first order differencing. Therefore, the house_mel series is likely $I(1)$.
