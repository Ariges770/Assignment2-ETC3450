---
title: "ETC3450 — Time Series Econometrics \\newline \\newline Assignment 2"
author:
- name: Ari Gestetner
  email: ages0001@student.monash.edu
- name: Nathan Giofkou
  email: ngio0003@student.monash.edu
- name: Mitchell Evans 
  email: meva0009@student.monash.edu
organization: ETC3450
bibliography: references.bib
format:
  html:
    execute:
      echo: true
    code-fold: true
  report-pdf:
    execute:
      echo: false
toc: true
execute: 
  warning: false
---

```{r}
#| eval: false

renv::load("Assignment2")
setwd("Assignment2")
```  

```{r}
library(tidyverse)
library(tsibble)
library(feasts)
library(dplyr)
library(urca)
library(tseries)

theme_set(theme_bw(base_size = 16))

housingdata <- read_csv("./housingdata.csv") |>
  tibble() |>
  mutate(date=yearquarter(date)) |>
  as_tsibble()
```  


# Stationarity: 

> Determine whether series are stationary (use visualisation and hypothesis tests)

```{r}
#| title: Plot data
#| layout-ncol: 2
#| layout-nrow: 2

housingdata |> 
  ggplot(aes(x=date,y=house_mel)) +
    labs(x="date", y="House_mel", title='Melb Median House Prices Over Time') +
    geom_line()

housingdata |> 
  ggplot(aes(x=date,y=appt_mel)) + 
    labs(x="date", y="appt_mel", title='Melb Median Apartment Prices Over Time') + 
    geom_line()

housingdata |> 
  ggplot(aes(x=date,y=house_syd)) + 
    labs(x="date", y="house_syd", title='Sydney Median House Prices Over Time') + 
    geom_line()

housingdata |> 
  ggplot(aes(x=date,y=appt_syd)) + 
    labs(x="date", y="appt_syd", title='Sydney Median Apartment Prices Over Time') + 
    geom_line()
```

Visually, all series look non-stationary as their means are clearly time dependent and all series exhibit an upwards trend. Doesn’t seem to be any seasonality.

## Formal Hypothesis tests

### Melbourne Housing Prices

```{r}
#| label: fig-melb-acf-pacf 
#| fig-cap: "ACF and PACF plots of Melbourne housing prices"
#| fig-subcap:
#|   - "The ACF has very slow decay, indicating non stationarity."
#|   - "Significant spike at lag $1$ in PACF indicates we use $1$ lag for an ADF test."
#| layout-ncol: 2

ACF(housingdata, house_mel) |>
  autoplot() +
  labs(x="Lag", y="ACF", title="ACF of Melbourne Housing data")
PACF(housingdata, house_mel) |>
  autoplot() +
  labs(x="Lag", y="PACF", title="PACF of Melbourne Housing data")

# ADF test (hm_ stands for homes melbourne)
hm_adf_result <- ur.df(housingdata$house_mel, type = "drift", selectlags = "AIC") 
hm_adf_result_sum <- summary(hm_adf_result)

hm_adf_teststat <- round(hm_adf_result_sum@teststat[1], 2)
hm_adf_cval <- round(hm_adf_result_sum@cval[1,2], 2)

#KPSS test
hm_kpss_result <- kpss.test(na.omit(housingdata$house_mel))
hm_kpss_pval <- round(hm_kpss_result$p.value, 2)
```


For the ADF test: The $\tau$ statistic was given as $`r hm_adf_teststat`$, which is greater than the critical value of $`r hm_adf_cval`$ at the $5\%$ significance level. Thus, we fail to reject $H_0$ and conclude that the series may have a unit root and differencing is necessary.

For the KPSS test: the $p$-value was given as $`r hm_kpss_pval`$, so we reject the null in favour of the series being non stationary, which supports the conclusion from the ADF test.

From the PACF, the strong spike at lag $1$ suggests the presence of persistence in the series, which is consistent with non-stationary behaviour. Combined with formal unit root tests, this indicates that the series likely becomes stationary after first order differencing. Therefore, the Melbourne housing series is likely $I(1)$.


### Melbourne Apartment Prices

```{r}
#| layout-ncol: 2

ACF(housingdata, appt_mel) |>
  autoplot() +
  labs(x="Lag", y="ACF", title="ACF of Melbourne Apartment data")
PACF(housingdata, appt_mel) |>
  autoplot() +
  labs(x="Lag", y="PACF", title="PACF of Melbourne Apartment data")

# ADF test (am_ stands for apartments melbourne)
am_adf_result <- ur.df(housingdata$appt_mel, type = "drift", selectlags = "AIC") 
am_adf_result_sum <- summary(am_adf_result)

am_adf_teststat <- round(am_adf_result_sum@teststat[1], 2)
am_adf_cval <- round(am_adf_result_sum@cval[1,2], 2)

#KPSS test
am_kpss_result <- kpss.test(na.omit(housingdata$appt_mel))
am_kpss_pval <- round(am_kpss_result$p.value, 2)
```  

For the ADF test: The $\tau$ statistic was given as $`r am_adf_teststat`$, which is greater than the critical value of $`r am_adf_cval`$ at the $5\%$ significance level. Thus, we fail to reject $H_0$ and conclude that the series may have a unit root and differencing is necessary.

For the KPSS test: the $p$-value was given as $`r hm_kpss_pval`$, so we reject the null in favour of the series being non stationary, which supports the conclusion from the ADF test.

From the PACF, the strong spike at lag $1$ suggests the presence of persistence in the series, which is consistent with non-stationary behaviour. Combined with formal unit root tests, this indicates that the series likely becomes stationary after first differencing. Therefore, the Melbourne apartment series is likely $I(1)$.


### Sydney Housing Prices

```{r}
#| label: fig-syd-acf-pacf 
#| fig-cap: ""
#| fig-subcap: 
#|   - ""
#|   - ""
#| layout-ncol: 2

ACF(housingdata, house_syd) |>
  autoplot() +
  labs(x="Lag", y="ACF", title="ACF of Sydney Housing data")
PACF(housingdata, house_syd) |>
  autoplot() +
  labs(x="Lag", y="PACF", title="PACF of Sydney Housing data")

# ADF test (hs_ stands for houses sydney)
hs_adf_result <- ur.df(housingdata$house_syd, type = "drift", selectlags = "AIC") 
hs_adf_result_sum <- summary(hs_adf_result)

hs_adf_teststat <- round(hs_adf_result_sum@teststat[1], 2)
hs_adf_cval <- round(hs_adf_result_sum@cval[1,2], 2)

#KPSS test
hs_kpss_result <- kpss.test(na.omit(housingdata$house_syd))
hs_kpss_pval <- round(hs_kpss_result$p.value, 2)
```


For the ADF test: The $\tau$ statistic was given as $`r hs_adf_teststat`$, which is greater than the critical value of $`r hs_adf_cval`$ at the $5\%$ significance level. Thus, we fail to reject $H_0$ and conclude that the series may have a unit root and differencing is necessary.

For the KPSS test: the $p$-value was given as $`r hs_kpss_pval`$, so we reject the null in favour of the series being non stationary, which supports the conclusion from the ADF test.

From the PACF, the strong spike at lag $1$ suggests the presence of persistence in the series, which is consistent with non-stationary behaviour. Combined with formal unit root tests, this indicates that the series likely becomes stationary after first differencing. Therefore, the Sydney housing series is likely $I(1)$.



### Sydney Apartment Prices

```{r}
#| layout-ncol: 2

ACF(housingdata, appt_syd) |>
  autoplot() +
  labs(x="Lag", y="ACF", title="ACF of Sydney Apartment data")
PACF(housingdata, appt_syd) |>
  autoplot() +
  labs(x="Lag", y="PACF", title="PACF of Sydney Apartment data")

# ADF test (as_ stands for apartments sydney)
as_adf_result <- ur.df(housingdata$appt_syd, type = "drift", selectlags = "AIC") 
as_adf_result_sum <- summary(as_adf_result)

as_adf_teststat <- round(as_adf_result_sum@teststat[1], 2)
as_adf_cval <- round(as_adf_result_sum@cval[1,2], 2)

#KPSS test
as_kpss_result <- kpss.test(na.omit(housingdata$appt_syd))
as_kpss_pval <- round(as_kpss_result$p.value, 2)
```


For the ADF test: The $\tau$ statistic was given as $`r as_adf_teststat`$, which is greater than the critical value of $`r as_adf_cval`$ at the $5\%$ significance level. Thus, we fail to reject $H_0$ and conclude that the series may have a unit root and differencing is necessary.

For the KPSS test: the $p$-value was given as $`r as_kpss_pval`$, so we reject the null in favour of the series being non stationary, which supports the conclusion from the ADF test.

From the PACF, the strong spike at lag $1$ suggests the presence of persistence in the series, which is consistent with non-stationary behaviour. Combined with formal unit root tests, this indicates that the series likely becomes stationary after first differencing. Therefore, the Sydney apartment series is likely $I(1)$.


## Conclusion on Stationarity:
All series are determined to be non-stationary and have unit roots. All are integrated of order $1$—$I(1)$; meaning that taking the first difference of each series should make each series stationary.
